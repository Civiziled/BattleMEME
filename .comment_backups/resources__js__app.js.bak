import './bootstrap';

import Alpine from 'alpinejs';

window.Alpine = Alpine;

Alpine.start();

// Theme toggle: store preference in localStorage and toggle `dark` class on <html>
function applyTheme(theme) {
	const root = document.documentElement;
	if (theme === 'dark') {
		root.classList.add('dark');
	} else {
		root.classList.remove('dark');
	}
}

function initThemeToggle() {
	const toggle = document.getElementById('theme-toggle');
	if (!toggle) return;

	const darkIcon = document.getElementById('theme-toggle-dark-icon');
	const lightIcon = document.getElementById('theme-toggle-light-icon');

	// Load saved preference or default to dark
	const saved = localStorage.getItem('theme') || 'dark';
	applyTheme(saved);
	if (saved === 'dark') {
		if (darkIcon) darkIcon.classList.remove('hidden');
		if (lightIcon) lightIcon.classList.add('hidden');
	} else {
		if (darkIcon) darkIcon.classList.add('hidden');
		if (lightIcon) lightIcon.classList.remove('hidden');
	}

	toggle.addEventListener('click', () => {
		const isDark = document.documentElement.classList.toggle('dark');
		localStorage.setItem('theme', isDark ? 'dark' : 'light');
		if (isDark) {
			if (darkIcon) darkIcon.classList.remove('hidden');
			if (lightIcon) lightIcon.classList.add('hidden');
		} else {
			if (darkIcon) darkIcon.classList.add('hidden');
			if (lightIcon) lightIcon.classList.remove('hidden');
		}
	});
}

document.addEventListener('DOMContentLoaded', initThemeToggle);
